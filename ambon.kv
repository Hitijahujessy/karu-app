#: kivy 2.1.0
#: import WipeTransition kivy.uix.screenmanager.WipeTransition
WindowManager:
    transition: WipeTransition()
    canvas.before:
        Color:
            rgba: 1, 1, 1, 1
        Rectangle:
            pos: self.pos
            size: self.size
    Menu:
    Interface:
    KaruHouse:
    SettingsScreen:

<Menu>:
    id: menu
    name: "first"
    orientation: 'vertical'
    size: root.width, root.height
    secondary_color: .4,.4,.4,1
    secondary_color2: 0,.7,.7,1
    canvas.before:
        Color:
            rgba: 1, 1, 1, 1
        Rectangle:
            pos: self.pos
            size: self.size


    Button:
	    id: start_button
        text: "Start"
        font_size: 32
        on_release: app.root.current = "second"
        size: root.width/2, root.height/12
        size_hint: None, None
        pos: root.width/4, root.height/2.5
        background_color: 0, 0, 0, 0
        canvas.before:
            Color:
                rgba: menu.secondary_color if start_button.state=='normal' else menu.secondary_color2
            RoundedRectangle:
                size: start_button.width, start_button.height
                pos: start_button.pos

    Button:
	    id: ruma_button
        text: "Karu's huis"
        font_size: 32
        on_release: app.root.current = 'third'
        size: root.width/2, root.height/12
        size_hint: None, None
        pos: root.width/4, root.height/3.3
        background_color: 0, 0, 0, 0
        canvas.before:
            Color:
                rgba: menu.secondary_color if ruma_button.state=='normal' else menu.secondary_color2
            RoundedRectangle:
                size: ruma_button.width, ruma_button.height
                pos: ruma_button.pos
    Button:
	    id: settings_button
        text: "Instellingen"
        font_size: 32
        on_release: app.root.current = 'fourth'
        size: root.width/2, root.height/12
        size_hint: None, None
        pos: root.width/4, root.height/4.8
        background_color: 0, 0, 0, 0
        canvas.before:
            Color:
                rgba: menu.secondary_color if settings_button.state=='normal' else menu.secondary_color2
            RoundedRectangle:
                size: settings_button.width, settings_button.height
                pos: settings_button.pos

    Image:
        source: 'resources/karu/karu.png'
        size: root.width/1.5, root.height/1.5
        size_hint: None, None
        pos: self.width/3.8, self.height/2
        pos_hint_y: None
        pos_hint_x: None

    Label:
        id: title
        text: "Bahasa Ambon met Karu"
        font_size: 47
        bold: True
        pos: self.width/64, self.height/2.8





<AmbonWidget>:
    bg: self.bg
    canvas.before:
        Color:
            rgba: 1, 1, 1, 1
        Rectangle:
            pos: self.pos
            size: self.size
            source: self.bg

<LetterButton@Button>
    background_color: 0,0,0,0  # the last zero is the critical on, make invisible
    secondary_color2: 0,.7,.7,.8
    canvas.before:
        Color:
            rgba: (.4,.4,.4,.8) if self.state=='normal' else (root.secondary_color2)  # visual feedback of press
        RoundedRectangle:
            pos: self.pos
            size: self.size

#:import Factory kivy.factory.Factory

<PopupMenu@Popup>
    auto_dismiss: False
    size_hint_y: .8
    size_hint_x: .9
    title: "Pauze"
    secondary_color: .4,.4,.4,1
    secondary_color2: 0,.7,.7,1

    FloatLayout:
        Slider:
            min: 0
            max: 100
            step: 1
            value: 50
            size_hint: .9, .25
            pos_hint: {'x':.05, 'y':.70}
        Slider
            min: 0
            max: 100
            step: 1
            value: 50
            size_hint: .9, .25
            pos_hint: {'x':.05, 'y':.55}
        Button:
            text: 'Menu'
            on_release: root.dismiss(); app.root.current = 'first'
            font_size: 32
            size: root.width/4, root.height/12
            size_hint: None, None
            pos_hint: {'x':.35, 'y':.25}
            background_color: 0, 0, 0, 0
            canvas.before:
                Color:
                    rgba: root.secondary_color if self.state=='normal' else root.secondary_color2
                RoundedRectangle:
                    size: self.size
                    pos: self.pos
        Button:
            text: ''
            on_release: root.aw.game_pause = False; root.aw.pause(); root.dismiss()
            font_size: 32
            size: root.width/4, root.height/12
            size_hint: None, None
            pos_hint: {'x':.35, 'y':.40}
            background_color: 0, 0, 0, 0
            canvas.before:
                Color:
                    rgba: root.secondary_color if self.state=='normal' else root.secondary_color2
                RoundedRectangle:
                    size: self.size
                    pos: self.pos
                Color:
                    rgba: 1,1,1,1
                RoundedRectangle:
                    size: self.width/2, self.height
                    pos: self.width*1.9, self.height*6
                    source: 'resources/icons/play.png'

<PopupBg@Popup>
    id: popup_bg
    size_hint_y: .65
    size_hint_x: .8
    title: ('KaruCoins: ' + str(round(self.wallet)))
    bg_btn1: bg_btn1

    bg_btn2: bg_btn2
    buy_btn2: buy_btn2

    bg_btn3: bg_btn3
    buy_btn3: buy_btn3

    ScrollView:
        do_scroll_x: True
        do_scroll_y: False
        pos: root.width, root.height
        GridLayout:
            cols: 3
            rows: 2
            padding: 135, 75, 135 ,75
            spacing: 165, 25
            size_hint_y: None
            height: self.minimum_height
            size_hint_x: None
            width: self.minimum_width
            Button:
                id: bg_btn1
                on_press: root.current_bg = 1; #root.test() ; self.disabled = True; bg2.disabled = False
                on_release: root.background_change()
                font_size: 32
                size: 360/1.5, 640/1.5
                size_hint: None, None
                pos: root.width/4, root.height/6
                background_color: 0, 0, 0, 0
                canvas.after:
                    Color:
                        rgba: (1,1,1,1) if bg_btn1.disabled==False else (0,0,0, .5)
                    RoundedRectangle:
                        size: self.width, self.height
                        pos: self.pos
                        source: root.data.backgrounds[1]

            Button:
                id: bg_btn2
                disabled: True
                bold: True
                color: 1, 1, 1, 1
                on_press: root.current_bg = 2; # root.test()#; self.disabled = True; bg1.disabled = False; bg3.disabled = False
                on_release: root.background_change()
                font_size: 30
                size: 360/1.5, 640/1.5
                size_hint: None, None
                pos: root.width/4, root.height/6
                background_color: 0, 0, 0, 0
                canvas.before:
                    Color:
                        rgba: (1,1,1,1) if bg_btn2.disabled==False else (1,1,1, .5)
                    RoundedRectangle:
                        size: self.width, self.height
                        pos: self.pos
                        source: root.data.backgrounds[2]

            Button:
                id: bg_btn3
                disabled: True
                bold: True
                color: 1, 1, 1, 1
                on_press: root.current_bg = 3;# root.test()#; self.disabled = True; bg1.disabled = False
                on_release: root.background_change()
                font_size: 30
                size: 360/1.5, 640/1.5
                size_hint: None, None
                pos: root.width/4, root.height/6
                background_color: 0, 0, 0, 0
                canvas.before:
                    Color:
                        rgba: (1,1,1,1) if bg_btn3.disabled==False else (1,1,1, .5)
                    RoundedRectangle:
                        size: self.width, self.height
                        pos: self.pos
                        source: root.data.backgrounds[3]

            Button:
                id: buy_btn1
                disabled: True
                text: root.price_str
                bold: True
                background_color: 0, 0, 0, 0
                pos: self.pos
                size_hint: None, None
                size: 360/1.5, 640/8
                canvas.before:
                    Color:
                        rgba: 0,.7,.7,1
                    RoundedRectangle:
                        pos: self.pos
                        size: self.size

            Button:
                id: buy_btn2
                disabled: False
                text: root.price_str
                bold: True
                on_press: root.current_bg = 2; # root.test()#; self.disabled = True; bg1.disabled = False; bg3.disabled = False
                on_release: root.background_change()
                background_color: 0, 0, 0, 0
                pos: self.pos
                size_hint: None, None
                size: 360/1.5, 640/8
                canvas.before:
                    Color:
                        rgba: (0,.7,.7,1) if self.state=='normal' else (0,.7,.7,.7)
                    RoundedRectangle:
                        pos: self.pos
                        size: self.size

            Button:
                id: buy_btn3
                disabled: False
                text: root.price_str
                bold: True
                on_press: root.current_bg = 3; # root.test()#; self.disabled = True; bg1.disabled = False; bg3.disabled = False
                on_release: root.background_change()
                background_color: 0, 0, 0, 0
                pos: self.pos
                size_hint: None, None
                size: 360/1.5, 640/8
                canvas.before:
                    Color:
                        rgba: (0,.7,.7,1) if self.state=='normal' else (0,.7,.7,.7)
                    RoundedRectangle:
                        pos: self.pos
                        size: self.size

#            Button:
#                id: bg_btn3_price
#                text: root.price_str
#                bold: True
#                color: 1, 1, 1, 1
#                on_press: root.current_bg = 3;# root.test()#; self.disabled = True; bg1.disabled = False
#                on_release: root.background_change()
#                font_size: 30
#                size: root.width/3.5, root.height/2.5
#                size_hint: None, None
#                pos: bg_btn3.pos
#                background_color: 0, 0, 0, 1
#                canvas.before:



<PopupOutfit@Popup>
    size_hint_y: .5
    size_hint_x: .8
    title: ('KaruCoins: ' + str(round(self.wallet)))

    BoxLayout:
        spacing: 15
        Button:
            text: "Coming soon..."
            bold: True
            on_press: print('COMING SOON')
            font_size: 32
            size: root.width/6, root.height/4
            size_hint: None, None
            pos: root.width/4, root.height/1.5
            background_color: 0, 0, 0, 1



<Interface>:
    name: "second"

    orientation: 'vertical'
    AmbonWidget:
        karulabel: karulabel
        highscore_label: highscore_label
        wallet_label: wallet_label

        secondary_color: .4,.4,.4,1
        secondary_color2: 0,.7,.7,1

        letterBtn1: LetterBtn1
        letterBtn2: LetterBtn2
        letterBtn3: LetterBtn3
        letterBtn4: LetterBtn4
        letterBtn5: LetterBtn5
        letterBtn6: LetterBtn6
        letterBtn7: LetterBtn7
        letterBtn8: LetterBtn8
        letterBtn9: LetterBtn9
        letterBtn10: LetterBtn10
        letterBtn11: LetterBtn11
        letterBtn12: LetterBtn12

        next_button: next_button

        help_button: help_button
        start_btn: start
        start_img: start_img
        #back_to_menu: back_to_menu
        finish_label: finish_label

        imagewidget: imagewidget

        answer: answer
        i: 0

        id: AmbonWidget

        canvas:
            Color:
                rgba: AmbonWidget.secondary_color
            RoundedRectangle:
                pos: root.width/1.2, root.height/1.15
                size: root.width/4, root.height/10

        Label:
            pos: root.width/1.15, root.height/1.08
            size: root.size
            text_size: self.width, self.height
            color: 1, 1, 1
            bold: True
            spacing: 3
            text: str(round(AmbonWidget.score))
            background_color:
        Label:
            id: highscore_label
            pos: root.width/1.15, root.height/1.14
            size: root.size
            text_size: self.width, self.height
            color: 1, 1, 1, .6
            bold: True
            spacing: 3
            text: str(round(AmbonWidget.highscore))
            background_color:
        Label:
            id: wallet_label
            pos: root.width/1.15, root.height/1.11
            size: root.size
            text_size: self.width, self.height
            color: 1, 1, 1, 1
            bold: True
            spacing: 3
            text: (str(round(AmbonWidget.wallet)) + 'KC')
            background_color:

        Image:
            id: imagewidget
            source: AmbonWidget.currentImage
            opacity: 0
            size: root.width/2, root.height/2
            pos: root.width/3.8, root.height/2.2

        Label:
            id: answer
            text: str(AmbonWidget.emptyspace)
            bold: True
            font_size: self.width/5
            color: 1, 1, 1
            size: root.width/2.5, root.height/2.5
            pos: self.width/1.3, self.height/1.12

        Button:
            id: next_button
            text: '>'
            on_press: AmbonWidget.words()
            disabled: True
            pos: self.width*1.5, self.height*7.25
            size: root.width/4, root.height/16
            color: (.0,.0,.0,.0) if self.disabled else (1,1,1,1)
            background_color: 0,0,0,0
            canvas.before:
                Color:
                    rgba: (.0,.0,.0,.0) if next_button.disabled else (.021,.4,.006,1)  # visual feedback of press
                RoundedRectangle:
                    pos: self.width*1.5, self.height*7.25
                    size: root.width/4, root.height/16
        Button:
            text: ' X '
            bold: True
            on_press: AmbonWidget.backspace()
            pos: self.width*2.5, self.height*3.25
            size: root.width/6, root.height/16
            background_color: 0,0,0,0
            canvas.before:
                Color:
                    rgba: (.4,.4,.4,.8) if self.state=='normal' else (0,.7,.7,.8)  # visual feedback of press
                RoundedRectangle:
                    pos: self.width*2.5, self.height*3.25
                    size: root.width/6, root.height/16

        Button: # Help Button
            id: help_button
            color: 0, 0, 0, 0
            background_color: 0, 0, 0, 0
            on_press: AmbonWidget.help()
            size: root.width/1.45, root.height/8
            pos: root.width/6, root.height/22

        FloatLayout:
            id: karufloat
            size: root.width, root.height/4
            pos: self.size

            Label:
                id: karulabel
                color: 1,1,1
                text: AmbonWidget.karu.speech
                multiline: True
                bold: True
                font_size: root.width*.045
                pos: root.width/26, root.height/550
                pos_hint_y: None
                pos_hint_x: None
                canvas.before:
                    Color:
                        rgba: AmbonWidget.secondary_color if help_button.state=='normal' else (AmbonWidget.secondary_color2)
                    RoundedRectangle:
                        size: root.width*.8, self.height/2
                        pos: root.width/9, root.height/26

            Image:
                source: 'resources/karu/karu.png'
                size: root.width/2.5, root.height/2.5
                size_hint: None, None

                pos_hint_y: None
                pos_hint_x: None



        GridLayout:
            rows: 3
            cols: 6
            spacing: 15, 30
            size: root.width/2, root.height/6.5
            pos: self.width/2, self.height*1.75

            LetterButton:
                id: LetterBtn1
                text:
                bold: True
                on_press: AmbonWidget.i = 0
                on_release: AmbonWidget.typeWord(), AmbonWidget.wordChecker()
            LetterButton:
                id: LetterBtn2
                text:
                bold: True
                on_press: AmbonWidget.i = 1
                on_release: AmbonWidget.typeWord(), AmbonWidget.wordChecker()
            LetterButton:
                id: LetterBtn3
                text:
                bold: True
                on_press: AmbonWidget.i = 2
                on_release: AmbonWidget.typeWord(), AmbonWidget.wordChecker()
            LetterButton:
                id: LetterBtn4
                text:
                bold: True
                on_press: AmbonWidget.i = 3
                on_release: AmbonWidget.typeWord(), AmbonWidget.wordChecker()
            LetterButton:
                id: LetterBtn5
                text:
                bold: True
                on_press: AmbonWidget.i = 4
                on_release: AmbonWidget.typeWord(), AmbonWidget.wordChecker()
            LetterButton:
                id: LetterBtn6
                text:
                bold: True
                on_press: AmbonWidget.i = 5
                on_release: AmbonWidget.typeWord(), AmbonWidget.wordChecker()
            LetterButton:
                id: LetterBtn7
                text:
                bold: True
                on_press: AmbonWidget.i = 6
                on_release: AmbonWidget.typeWord(), AmbonWidget.wordChecker()
            LetterButton:
                id: LetterBtn8
                text:
                bold: True
                on_press: AmbonWidget.i = 7
                on_release: AmbonWidget.typeWord(), AmbonWidget.wordChecker()
            LetterButton:
                id: LetterBtn9
                text:
                bold: True
                on_press: AmbonWidget.i = 8
                on_release: AmbonWidget.typeWord(), AmbonWidget.wordChecker()
            LetterButton:
                id: LetterBtn10
                text:
                bold: True
                on_press: AmbonWidget.i = 9
                on_release: AmbonWidget.typeWord(), AmbonWidget.wordChecker()
            LetterButton:
                id: LetterBtn11
                text:
                bold: True
                on_press: AmbonWidget.i = 10
                on_release: AmbonWidget.typeWord(), AmbonWidget.wordChecker()
            LetterButton:
                id: LetterBtn12
                text:
                bold: True
                on_press: AmbonWidget.i = 11
                on_release: AmbonWidget.typeWord(), AmbonWidget.wordChecker()

        Button:
            id: menupop
            on_press: AmbonWidget.game_pause = True; AmbonWidget.pause(); Factory.PopupMenu().open()
            on_release: print(AmbonWidget.game_pause)
            background_color: 0,0,0,0
            #size: self.width/1.25, self.height/1.25
            pos: root.width/32, root.height/1.11
            canvas.before:
                Color:
                    rgba: AmbonWidget.secondary_color if self.state=='normal' else AmbonWidget.secondary_color2
                RoundedRectangle:
                    size: self.width/1.25, self.height/1.25
                    pos: root.width/32, root.height/1.11
            canvas.after:
                Color:
                    rgba: 1,1,1,1
                RoundedRectangle:
                    size: self.width/1.25, self.height/1.25
                    pos: root.width/32, root.height/1.11
                    source: 'resources/icons/pause.png'
        Button:
            id: start
            text: 'Raak het scherm aan\n   om te beginnen!'
            bold: True
            background_color: 0, 0, 0, .3
            size: root.size
            on_release: AmbonWidget.start_or_menu(); AmbonWidget.game_pause = False; AmbonWidget.pause()
            on_press: app.root.current = 'first' if AmbonWidget.go_to_menu else print('nothing')

        Image:
            id: start_img
            source: 'resources/karu/karu.png'
            size: root.width/1.5, root.height/1.5
            size_hint: None, None
            pos: self.width/4, self.height/2
            pos_hint_y: None
            pos_hint_x: None

        Label:
            id: finish_label
            text: 'Goed gedaan!\n   Mantap e!'
            font_size: 47
            color: 0, 0, 0, 0
            bold: True
            pos: self.width*3.25, self.height*5




<KaruHouse>:
    name: "third"
    orientation: 'vertical'
    size: root.width, root.height
    secondary_color: .4,.4,.4,.8
    secondary_color2: 0,.7,.7,.8

    canvas.before:
        Color:
            rgba: 1, 1, 1, 1
        Rectangle:
            pos: self.pos
            size: self.size


    Button:
        text: 'Achtergronden'
        size: root.width/2, root.height/12
        size_hint: None, None
        on_release: Factory.PopupBg().open()
        pos: root.width/4, root.height/1.5
        background_color: 0, 0, 0, 0
        canvas.before:
            Color:
                rgba: root.secondary_color if self.state=='normal' else root.secondary_color2
            RoundedRectangle:
                size: self.size
                pos: self.pos

    Button:
        text: 'Outfits'
        size: root.width/2, root.height/12
        size_hint: None, None
        on_release: Factory.PopupOutfit().open()
        pos: root.width/4, root.height/2
        background_color: 0, 0, 0, 0
        canvas.before:
            Color:
                rgba: root.secondary_color if self.state=='normal' else root.secondary_color2
            RoundedRectangle:
                size: self.size
                pos: self.pos





    Button:
        text: "Menu"
        font_size: 32
        on_release: app.root.current = 'first'
        size: root.width/2, root.height/12
        size_hint: None, None
        pos: root.width/4, root.height/3.3
        background_color: 0, 0, 0, 0
        canvas.before:
            Color:
                rgba: root.secondary_color if self.state=='normal' else root.secondary_color2
            RoundedRectangle:
                size: self.size
                pos: self.pos

<SettingsScreen>:
    name: "fourth"
    orientation: 'vertical'
    size: root.width, root.height
    secondary_color: .4,.4,.4,.8
    secondary_color2: 0,.7,.7,.8
    canvas.before:
        Color:
            rgba: 1, 1, 1, 1
        Rectangle:
            pos: self.pos
            size: self.size


    Button:
        text: "Menu"
        font_size: 32
        on_release: app.root.current = 'first'
        size: root.width/2, root.height/12
        size_hint: None, None
        pos: root.width/4, root.height/3.3
        background_color: 0, 0, 0, 0
        canvas.before:
            Color:
                rgba: root.secondary_color if self.state=='normal' else root.secondary_color2
            RoundedRectangle:
                size: self.size
                pos: self.pos